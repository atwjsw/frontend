<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>微专业前端开发作业</title>
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" href="css/style.css">
    <meta name="description" content="网易前端开发工程师微专业作业">
 
 
</head>
<body>
    <!-- 提醒通知条 -->
    <div class="g-notice">
        <div class="txtarea">
            <span class="text">网易云课堂微专业，帮助你掌握专业技能，令你求职或加薪多一份独特优势!</span>
            <a class="check" href="#">立即查看></a>
            <a class="noremind" href="#"><span class="close"></span> 不再提醒</a>
        </div>      
    </div>
    <!-- /提醒通知条 -->	

    <!-- 顶栏1 -->
    <div class="g-top1">
        <div class="txtarea">
            <p class="edu">EDU</p>
            <p class="divider1">|</p>
            <p class="netease">网易教育产品部</p>
            <p class="attention"><em>+</em> 关注</p>
            <div class="attnDone"><span class="tick"></span><span> 已关注 </span><span class="divider2">|</span> <a>取消</a></div>
            <span class="fans">粉丝 45</span>
            <div class="m-navbar1">
                <ul>
                    <li><a href="http://open.163.com/" target="_blank">网易公开课</a></li>
                    <li><a href="http://study.163.com/" target="_blank">云课堂</a></li>
                    <li><a href="http://www.icourse163.org/" target="_blank">中国大学MOOC</a></li>
                    <li class="search"></li>
                </ul>
            </div>
         </div>     
    </div>
    <!-- /顶栏1  -->

    <!-- 轮播图 -->
    <div class="m-slide">
       <ul class="m-cursor">
          <li class='cursor'></li>
          <li class='cursor'></li>
          <li class='cursor'></li>         
        </ul>
    </div>
    <!-- /轮播图 -->
 
     <!-- 顶栏2 -->
    <div class="g-top2">
        <div class="txtarea">
        <ul>
        <li>
            <div class="circle"><div class="logo1"></div></div>
            <div class="txt">
                <h3>网易公开课</h3>
                <p>推出国内外名校课程，涉及广泛的学科，名校老师认真讲解深度剖析，网易视频公开课频道搭建起强有力的网络视频教学平台。</p>
                <a href="http://open.163.com/" target="_blank">了解更多 ></a>
            </div>
        </li>
        <li>
            <div class="circle"><div class="logo2"></div></div>
            <div class="txt">
                <h3>云课堂</h3>
                <p>网易旗下大型在线学习平台，该平台面向学习者提供海量免费、优质课程，创新的个性化学习体验，自由开发的交流互动环境</p>
                <a href="http://study.163.com/" target="_blank">了解更多 ></a>
            </div>
        </li>
        <li>
            <div class="circle"><div class="logo3"></div></div>
            <div class="txt">
                <h3>中国大学MOOC</h3>
                <p>是爱课程网携手云课堂打造的在线学习平台，每一个有提升愿望的人，都可以在这里学习中国最好的大学课程，学完后还能获得认证证书。</p>
                <a href="http://www.icourse163.org/" target="_blank">了解更多 ></a>
            </div>
        </li>
        </ul>
        </div>           
    </div>
    <!-- /顶栏2 -->

    <!-- 工作环境图片区 -->
    <div class="workenv">
        <div class="img"></div>       
    </div>
     <!-- /工作环境图片区 -->

    <!-- 主内容区 -->
    <div class="m-body">
        <!-- 课程Tab切换 -->
        <div class="m-tab">
            <ul>
                <li class="product z-crt"><a href="">产品设计</a></li>
                <li class="program"><a href="">编程语言</a></li>
           </ul>
        </div>
        <!-- /课程Tab切换 -->

        <!-- 课程列表 -->
        <div class="m-list">     
        </div> 
        <!-- /课程列表 -->

        <!-- 机构介绍 -->
        <div class="m-introduction">
            <div class="title">机构介绍</div>
            <div class="video">
                <p>观看下面的视频了解吧:</p>
                <img src="imgs/videos.jpg" width="180px" height="110px"></img>

               <!--  <video  id="example_video_1" class="video-js vjs-default-skin" controls preload="none" src="http://mov.bn.netease.com/open-movie/nos/mp4/2014/12/30/SADQ86F5S_shd.mp4" poster= width="180px" height="110px">
                    <source src="movie.mp4" type="video/mp4">
                    <source src="movie.ogg" type="video/ogg">
                </video> -->
            </div>
        </div>
        <!-- /机构介绍 -->

         <!-- 热门推荐 -->
        <div class="m-hotlist">
            <div class="title">最热排行</div>
            <div class="hotlist"></div>
        </div>
        <!-- /热门推荐 -->   

        <!-- 视频弹窗 -->
        <div class="g-video">       
            <p class="title">请观看下面的视频</p>
            <div class="close"></div>       
            <video src="http://mov.bn.netease.com/open-movie/nos/mp4/2014/12/30/SADQ86F5S_shd.mp4" poster="imgs/videol.jpg" width="889px" height="538px" controls></video>       
        </div>   
        <!-- /视频弹窗 -->

         <!-- 翻页器 -->
        <div class="m-page">          
              <span class="prev" href="#"><</span>
              <span class="pgi z-crt" href="#">1</span>
              <span class="pgi" href="#">2</span>
              <span class="pgi" href="#">3</span>
              <span class="pgi" href="#">4</span>
              <span class="pgi" href="#">5</span>
              <span class="pgi" href="#">6</span>
              <span class="pgi" href="#">7</span>
              <span class="pgi" href="#">8</span>
              <span class="next" href="#">></span>             
        </div>            
    </div>
    <!-- /主内容区 -->     
   
    <!-- 底栏 -->
     <div class="m-bottom">
        <div class="txtarea">
        <div class="area1"> 
            <div class="edu">EDU</div>
            <div class="netease">| 网易教育产品部</div>   
            <div class="icp">&copy2014 icourse163.org 浙ICP备08114786号-1</div>
            <div class="icp">icourses.cn 京ICP备12020869号-2 京公网安备110102000-2</div>
        </div>        
        <div class="area2"> 
            <div class="title">友情链接：</div>
            <div><a href="http://open.163.com/" target="_blank">网易公开课</a></div>
            <div><a href="http://study.163.com/" target="_blank">网易云课堂</a></div>
            <div><a href="http://www.icourse163.org/" target="_blank">中国大学MOOC</a></div>        
        </div>     
        <div class="area3"> 
            <div class="title">我们：</div>
            <div><a href="">关于</a></div>
            <div><a href="">联系</a></div>
            <div><a href="">关注</a><span class="weibo"></span></div>        
        </div>
        <div class="area4"> 
            <div class="title">更多：</div>
            <div><a href="">常见问题</a></div>
            <div><a href="">意见反馈</a></div>              
        </div>
        </div>      
    </div>
    <!-- /底栏 -->

    <!-- 登录框 -->  
        <form action="/login" class="m-form" name="loginForm" autocomplete="off">
        <!-- target="result"  -->
          <legend>登录网易云课堂</legend>
          <fieldset>
            <div class="msg" id="message"></div>
            <div>
                <input id="userName" name="userName" type="text" class="u-txt" maxlength="30" placeholder="账号"
                     required>
            </div>
            <div>           
              <input id="password" name="password" type="password" class="u-txt" placeholder="密码" required>    
            </div>
            <div><button name="loginBtn">登 录</button></div>
          </fieldset>
          <div class="close"></div>
        </form>
    <!--/ 登录框 -->

    <!-- 遮罩 --> 
    <div class="mask"></div>
    <!-- /遮罩 --> 
  
<script src='js/util.js'></script>
<script src='js/ajax.js'></script>
<script src='js/md5.js'></script>
<script src='js/trimpath.js'></script>
<script src='js/slider.js'></script>
<script src='js/login.js'></script>


<!-- 热门课程列表 -->  
<script type="text/template" id="hotlist">
    <ul>
        {list courselist as hotcourse}
        <li>
           <a href="" class="img"><img src="${hotcourse.smallPhotoUrl}" alt="电台名称" width="50px" height="50px"></a>
           <div class="txt">
           <h3><a href="">${hotcourse.name}</a></h3>
               <div class="info">
               <p>${hotcourse.learnerCount}</p>
            </div>
         </li>
         {/list}
    </ul>
</script>
<!-- /热门课程列表 -->

<!-- 课程列表 -->  
<script type="text/template" id="track-list">  
         <ul>
        {list courselist as track}
          <li>  
                <div class="normal">
                    <a href=""><img src="${track.middlePhotoUrl}" width="225px" height="124px" alt="课程图片"></a>
                    <p class="title">${track.name}</p> 
                    <p class="author">${track.provider}</p>
                    <p class="fans">${track.learnerCount}</p>
                    <p class="price">{if track.price == "0"}免费{else}￥${track.price}{/if}</p>
                </div>
                <div class="hover">
                    <div class="upper">
                    <a href=""><img src="${track.bigPhotoUrl}" width="225px" height="124px" alt="课程图片"></a>
                        <div class="txt">
                            <p class="title">${track.name}</p>                            
                            <p class="info">${track.learnerCount}人在学</p>
                            <p class="provider">发布者：${track.provider}</p>
                            <p class="category">分类：${track.categoryName}</p>                            
                        </div>
                    </div>
                    <div class="lower">
                         <p>${track.description}</p>           
                    </div>
                </div>                
           </li>           
         {/list}
         </ul>
</script>
<!-- /课程列表 --> 

<script type="text/javascript">
        


        var pageNo=1;
        var type=10;
        var psize=20;
    
        var gdoc = $('.m-body')[0];
        // var width = window.getComputedStyle(gdoc).getPropertyValue("width");
        var width = getStyle(gdoc, "width");    
        if (width=='960px') {
            psize=15;
        }

        var courselist =  $('.m-hotlist .hotlist')[0];
        var hotlist = $('.m-hotlist .hotlist')[0];
        
         var tplContent = TrimPath.parse(
           // document.getElementById('track-list').textContent
           document.getElementById('track-list').innerHTML
        );

        var hotListContent = TrimPath.parse(
            // document.getElementById('hotlist').textContent
            document.getElementById('hotlist').innerHTML
        );
   
        function render(parent,list,template){
            // alert(list.totalCount);
           
            var config = {
                dur2str:function(duration){
                    duration = duration/1000;
                    var m = Math.floor(duration/60),
                        s = Math.floor(duration%60);
                    return (m<10?'0':'')+m+':'+(s<10?'0':'')+s;
                }
            };
            var html = TrimPath.merge(
                 template,{courselist:list},config
               
            );
             parent.insertAdjacentHTML('afterBegin',html);
        }

        // Tab交互      

        addEvent($('.m-tab .product')[0], "click", function(event) {
            // event.preventDefault(); 
            event.preventDefault ? event.preventDefault() : (event.returnValue = false);
            type=10;           
            makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:1, psize:psize, type:type}, "GET", processCourselist); 
            $('.m-tab .program')[0].style.backgroundColor="white";
            $('.m-tab .program a')[0].style.color="#666" ; 
            $('.m-tab .product')[0].style.backgroundColor="#39a030";
            $('.m-tab .product a')[0].style.color="white";   
            util.delClass($('.m-page .z-crt')[0],"z-crt"); 
            util.addClass($('.m-page .pgi')[0], "z-crt");              
            return false;
        });

        addEvent($('.m-tab .program')[0], "click", function(event) {
            event.preventDefault();
            type=20;
            makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:1, psize:psize, type:type}, "GET", processCourselist); 
            $('.m-tab .program')[0].style.backgroundColor="#39a030";
            $('.m-tab .program a')[0].style.color="white" ; 
            $('.m-tab .product')[0].style.backgroundColor="white";
            $('.m-tab .product a')[0].style.color="#666" ; 
            util.delClass($('.m-page .z-crt')[0],"z-crt"); 
            util.addClass($('.m-page .pgi')[0], "z-crt");                            
            return false;
        });
        
         function processCourselist(data) {            
            var arr = JSON.parse(data).list;
            var courselist =  $('.m-list')[0];
            $('.m-list')[0].innerHTML="";            
            render(courselist, arr, tplContent);  
            addMouseoverHandler($('.m-list div.normal'));  
            addMouseoutHandler($('.m-list div.hover'));         
         }

         function processHotlist(data) {    
            var arr = JSON.parse(data); 
                    // $('.m-hotlist .hotlist')[0].textContent=""; 
                    $('.m-hotlist .hotlist')[0].innerHTML=""; 
                    render(hotlist, arr.slice(0,10), hotListContent); 
                    setInterval(function(){
                    $('.m-hotlist .hotlist')[0].innerHTML=""; 
                    render(hotlist, arr.slice(0,10), hotListContent);
                    var firstItem = arr.shift();                
                    arr.push(firstItem);
                },5000)               
            }                 
      

        //数组处理
        function arrayGroup(arr, groupsize, groupId) {
            console.log(arr.length);
            console.log(groupsize*(groupId-1));
            console.log(groupsize*groupId);
            return arr.slice(groupsize*(groupId-1), groupsize*groupId);
        }
  

    //课程列表浮层交互
       // window.addEventListener("load", function() {  
         
      function addMouseoverHandler(nodes) { 
         function helper(i) {   
           return  function() {
                // setTimeout(function(){
                    $('.m-list div.hover')[i].style.display="block"} 
                    // ,500);             
                // }// $('.m-list div.hover')[i].style.zIndex="100"; 
           }        
       

        for (var i=0;i<nodes.length;i++) {
            // alert(i);
            addEvent(nodes[i],"mouseenter", helper(i))
        }
    }

    function addMouseoutHandler(nodes) {
        function helper(i) {   
           return  function() {            
                    $('.m-list div.hover')[i].style.display="none"
                }          
           }  
        for (var i=0;i<nodes.length;i++) {
            addEvent(nodes[i], "mouseleave", helper(i))
        }
    }
           
    // 热门课程列表

    addEvent(window, "load", function() {
      makeCorsRequest("http://study.163.com/webDev/hotcouresByCategory.htm", {},  "GET", processHotlist);  
      makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:1, psize:psize, type:10 },  "GET" ,processCourselist); 
    });
    
    
    pageIndexes = $('.m-page .pgi');
    var prev = $('.m-page .prev')[0];
    var next = $('.m-page .next')[0];
    var currentPage=1;
    addClickHandler(pageIndexes);

    //翻页器交互, 点击页码翻页
      function addClickHandler(nodes) {
        function helper(i) {
           return function(){          
                util.delClass($('.m-page .z-crt')[0],"z-crt");
                currentPage = i+1;                
                makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:currentPage, psize:psize, type:type },"GET",processCourselist); 
                util.addClass(nodes[i],"z-crt");              
       }
    }
        for (var i=0;i<nodes.length;i++) {
            addEvent(nodes[i],"click", helper(i));            
        }
    }
        
         
     //翻页器交互, 点击向前、向后键翻页
    addEvent(prev, "click", function() {        
        // alert("prev" + currentPage);
        if (currentPage>1) {           
            currentPage=currentPage-1;
            makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:currentPage, psize:psize, type:type }, "GET", processCourselist); 
            util.delClass(pageIndexes[currentPage],"z-crt");
            util.addClass(pageIndexes[currentPage-1],"z-crt");
        }
    }) 
    
    addEvent(next, "click", function() {
        if (currentPage<8) {           
            currentPage=currentPage+1;
            makeCorsRequest("http://study.163.com/webDev/couresByCategory.htm", {pageNo:currentPage, psize:psize, type:type }, "GET",processCourselist); 
            util.delClass(pageIndexes[currentPage-2],"z-crt");
            util.addClass(pageIndexes[currentPage-1],"z-crt");
        }
    }) 

</script>   
</body>
</html>
